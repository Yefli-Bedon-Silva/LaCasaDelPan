<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
        <title>AdminPan</title>
        <link rel="stylesheet" href="/css/Admin.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js" integrity="sha512-CQBWl4fJHWbryGE+Pc7UAxWMUMNMWzWxF4SQo9CgkJIN1kx6djDQZjh3Y8SZ1d+6I+1zze6Z7kHXO7q3UyZAWw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <style>
            /* Asegura que los canvas tengan tamaño visible */
            canvas {
                max-width: 100%;
                height: 300px !important;
            }
        </style>
    </head>
    <body>

        <!-- Sidebar -->
        <div class="sidebar position-fixed d-flex flex-column p-3">
            <a href="/admin" class="d-flex align-items-center mb-4 text-white text-decoration-none">
                <i class="fas fa-bread-slice fs-3 me-2"></i><span class="fs-4 fw-semibold">MundoPan</span>
            </a>
            <ul class="nav nav-pills flex-column mb-auto">
                <li><a href="/admin" class="nav-link active"><i class="fas fa-home me-2"></i>Inicio</a></li>
                <li><a href="/adminproductos" class="nav-link"><i class="fas fa-box-open me-2"></i>Productos</a></li>
                <li><a href="/adminventas" class="nav-link"><i class="fas fa-shopping-cart me-2"></i>Pedidos</a></li>
                <li><a href="/adminreclamos" class="nav-link"><i class="fas fa-exclamation-triangle me-2"></i>Reclamos</a></li>
                <li><a href="/adminclientes" class="nav-link"><i class="fas fa-users me-2"></i>Clientes</a></li>
            </ul>
            <hr />
            <div class="mt-auto">
                <a class="nav-link text-danger"><i class="fas fa-sign-out-alt me-2"></i>Cerrar sesión</a>
            </div>
        </div>


        <!-- Contenido principal -->
        <div class="content">
            <nav class="header navbar navbar-expand bg-white px-4 align-items-center">
                <button class="btn btn-sm btn-outline-secondary me-3" id="toggleSidebar"><i class="fas fa-bars"></i></button>
                <div class="ms-auto d-flex align-items-center">
                    <i class="fas fa-user-circle fa-2x text-secondary me-2"></i>
                    <span th:text="'Bienvenido, ' + ${nombreUsuario}"></span>
                    <form th:action="@{/logout}" method="post" id="logoutForm" style="display:inline;">
                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                        <button type="submit" class="btn btn-outline-danger btn-sm ms-3">Cerrar sesión</button>
                    </form>
                </div>
            </nav>

            <div class="container-fluid py-5">
                <h1 class="fw-bold text-center mb-4">Bienvenido Administrador(a)</h1>
                <h4 class="text-start ps-3 mb-4">Dashboard:</h4>

                <div class="row g-4 mb-5">
                    <div class="col-md-3">
                        <div class="card text-center p-3">
                            <h5>Usuarios Registrados</h5>
                            <p class="display-4" th:text="${totalUsuarios}">150</p>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card text-center p-3">
                            <h5>Productos</h5>
                            <p class="display-4" th:text="${totalProductos}">40</p>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card text-center p-3">
                            <h5>Ventas Hoy</h5>
                            <p class="display-4" th:text="${ventasHoy}">25</p>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card text-center p-3">
                            <h5>Pedidos Pendientes</h5>
                            <p class="display-4" th:text="${pedidosPendientes}">8</p>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <!-- Gráfico de barras: Ventas por día -->
                    <div class="col-md-6">
                        <canvas id="ventasChart"></canvas>
                    </div>
                    <!-- Gráfico circular: Distribución de productos -->
                    <div class="col-md-6">
                        <canvas id="productosChart"></canvas>
                    </div>
                </div>
            </div>

            <script>
                // Datos 
                const ventasData = {
                    labels: ['Lun', 'Mar', 'Mié', 'Jue', 'Vie', 'Sáb', 'Dom'],
                    datasets: [{
                            label: 'Ventas',
                            data: [12, 19, 15, 22, 18, 25, 20],
                            backgroundColor: 'rgba(182, 141, 64, 0.7)'
                        }]
                };

                const productosData = {
                    labels: ['Pan Francés', 'Alfajores', 'Keke Vainilla', 'Torta Chocolate'],
                    datasets: [{
                            label: 'Productos vendidos',
                            data: [120, 100, 40, 30],
                            backgroundColor: [
                                'rgba(182, 141, 64, 0.7)',
                                'rgba(150, 120, 50, 0.7)',
                                'rgba(200, 170, 80, 0.7)',
                                'rgba(220, 190, 100, 0.7)'
                            ]
                        }]
                };

                // Configuración y renderizado de gráficos
                const ctxVentas = document.getElementById('ventasChart').getContext('2d');
                new Chart(ctxVentas, {
                    type: 'bar',
                    data: ventasData,
                    options: {
                        responsive: true,
                        plugins: {legend: {display: false}}
                    }
                });

                const ctxProductos = document.getElementById('productosChart').getContext('2d');
                new Chart(ctxProductos, {
                    type: 'doughnut',
                    data: productosData,
                    options: {
                        responsive: true,
                        plugins: {legend: {position: 'bottom'}}
                    }
                });
            </script>

            <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
    </body>
</html>